<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Stacking Plan</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .floor {
      display: flex;
      margin-bottom: 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      overflow: hidden;
    }
    .suite {
      flex: 1;
      padding: 10px;
      text-align: center;
      border-right: 1px solid #ddd;
      background: #e0e7ff;
      font-size: 14px;
    }
    .suite:last-child {
      border-right: none;
    }
    .floor-label {
      margin-bottom: 6px;
      font-weight: bold;
      font-size: 16px;
    }
  </style>
</head>
<body>

<div id="stackingPlan"></div>

<script>
  const suites = [
    { floor: 3, suite: "A", type: "Office" },
    { floor: 3, suite: "B", type: "Office" },
    { floor: 2, suite: "A", type: "Lab" },
    { floor: 2, suite: "B", type: "Lab" },
    { floor: 2, suite: "C", type: "Retail" },
    { floor: 1, suite: "A", type: "Lobby" }
  ];

  const planContainer = document.getElementById('stackingPlan');

  const grouped = suites.reduce((acc, item) => {
    acc[item.floor] = acc[item.floor] || [];
    acc[item.floor].push(item);
    return acc;
  }, {});

  const sortedFloors = Object.keys(grouped).sort((a, b) => b - a);

  sortedFloors.forEach(floor => {
    const label = document.createElement('div');
    label.className = 'floor-label';
    label.textContent = `Floor ${floor}`;
    planContainer.appendChild(label);

    const row = document.createElement('div');
    row.className = 'floor';

    grouped[floor].forEach(suite => {
      const block = document.createElement('div');
      block.className = 'suite';
      block.textContent = `Suite ${suite.suite} (${suite.type})`;
      row.appendChild(block);
    });

    planContainer.appendChild(row);
  });
</script>

 <script>
  // Example render function that takes suite data and builds the stacking plan
  function render(suites) {
    const container = document.getElementById('stackingPlan');
    container.innerHTML = ''; // Clear previous content

    const grouped = suites.reduce((acc, item) => {
      acc[item.floor_number] = acc[item.floor_number] || [];
      acc[item.floor_number].push(item);
      return acc;
    }, {});

    const sortedFloors = Object.keys(grouped).sort((a, b) => b - a);
    sortedFloors.forEach(floor => {
      const label = document.createElement('div');
      label.className = 'floor-label';
      label.textContent = `Floor ${floor}`;
      container.appendChild(label);

      const row = document.createElement('div');
      row.className = 'floor';

      grouped[floor].forEach(suite => {
        const block = document.createElement('div');
        block.className = 'suite';
        block.textContent = `Suite ${suite.suite} (${suite.type})`;
        row.appendChild(block);
      });

      container.appendChild(row);
    });
  }

  // ðŸ”¥ This listens for messages from Retool
  window.addEventListener("message", (event) => {
    if (Array.isArray(event.data)) {
      render(event.data); // <-- this triggers the UI update
    }
  });
</script>

</body>
</html>
